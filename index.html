<!DOCTYPE html><html lang="en"><head>
    <title>EJ2 Grid</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Typescript Grid Control">
    <meta name="author" content="Syncfusion">
    
    <script src="ej2.min.js"></script>
    
    <link href="https://cdn.syncfusion.com/ej2/29.1.39/tailwind3.css" rel="stylesheet">

    <style>
        .e-grid-barchart-icon::before {
            content: '\e86c';
            font-family: 'e-icons';
        }

        .e-grid-barchart-normal-icon::before {
            content: '\e86c';
            font-family: 'e-icons';
        }

        .e-grid-barchart-stacked-icon::before {
            content: '\e866';
            font-family: 'e-icons';
        }

        .e-grid-linechart-icon::before {
            content: '\e8c3';
            font-family: 'e-icons';
        }

        .e-grid-linechart-normal-icon::before {
            content: '\e8c2';
            font-family: 'e-icons';
        }

        .e-grid-linechart-stacked-icon::before {
            content: '\e8c1';
            font-family: 'e-icons';
        }

        .e-grid-areachart-icon::before {
            content: '\e870';
            font-family: 'e-icons';
        }

        .e-grid-areachart-normal-icon::before {
            content: '\e870';
            font-family: 'e-icons';
        }

        .e-grid-areachart-range-icon::before {
            content: '\e871';
            font-family: 'e-icons';
        }

        .e-grid-chart-dialog-max-icon::before {
            content: '\e72f';
            font-family: 'e-icons';
        }

        .e-grid-chart-dialog-min-icon::before {
            content: '\e7ed';
            font-family: 'e-icons';
        }

        .e-grid-context-menu-dialog .e-chart-list-icon {
            cursor: pointer;
            margin-top: 10px;
            margin-left: 10px;
            margin-right: 10px;
            line-height: 1;
            font-size: 50px;
            padding-top: 5px;
            padding-left: 5px;
            padding-right: 5px;
            border: 2px solid white;
        }

        .e-grid-context-menu-dialog .e-chart-list-icon.e-chart-list-icon-selected {
            border: 2px solid orange;
        }

        .e-grid-context-menu-dialog .e-grid-chart-dialog-min-max {
            padding: 6px 10px;
            border: 0px;
            position: relative;
            float: right;
        }
    </style>
</head>
<body>
    <br/>
    <br/>
    <br/>
    <br/>
    <div id="Grid"></div>
<script >
    var data = [];
    var dataCount = 20;
    var year = new Date().getFullYear() - dataCount;
    var fruits = [
        "Apple",
        "Banana",
        "Mango",
        "Orange",
        "Pineapple",
        "Grapes",
        "Strawberry",
        "Watermelon",
        "Papaya",
        "Blueberry",
        "Kiwi",
        "Peach",
        "Pear",
        "Cherry",
        "Pomegranate",
        "Guava",
        "Lychee",
        "Plum",
        "Coconut",
        "Dragon fruit"
    ];
    var getRandomNumber = function (min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    };
    for (var i = 0; i < dataCount; i++) {
        var loss = getRandomNumber(5, 70);
        data.push({
            Name: fruits[Math.floor(Math.random() * fruits.length)],
            Year: year + i,
            Profit: 100 - loss,
            Loss: loss,
            Quality: getRandomNumber(20, 95),
            Quantity: getRandomNumber(50000, 70000)
        });
    }
    data.reverse();

    ej.base.enableRipple(true);
    ej.base.L10n.load({
        'fr-BE': {
            'dialog': {
                'close': 'Fermer'
            }
        }
    });
    var chartList = [
        {
            text: 'Bar',
            id: 'bar',
            iconCss: 'e-grid-barchart-icon',
            items: [
                {
                    text: 'Normal',
                    id: 'normalbar',
                    iconCss: 'e-grid-barchart-normal-icon',
                },
                {
                    text: 'Stacked',
                    id: 'stackedbar',
                    iconCss: 'e-grid-barchart-stacked-icon',
                }
            ],
        },
        {
            text: 'Area',
            id: 'area',
            iconCss: 'e-grid-areachart-icon',
            items: [
                {
                    text: 'Normal',
                    id: 'normalarea',
                    iconCss: 'e-grid-areachart-normal-icon',
                },
                {
                    text: 'Range',
                    id: 'rangearea',
                    iconCss: 'e-grid-areachart-range-icon',
                },
            ]
        },
        {
            text: 'Line',
            id: 'line',
            iconCss: 'e-grid-linechart-icon',
            items: [
                {
                    text: 'Normal',
                    id: 'normalline',
                    iconCss: 'e-grid-linechart-normal-icon',
                },
                {
                    text: 'Stacked',
                    id: 'stackedline',
                    iconCss: 'e-grid-linechart-stacked-icon',
                }
            ],
        }
    ];
    var valueAccessor = function (field, data, column) {
        return data[field] + "%";
    };
    var getChartSeriesType = function (id) {
        return id === 'normalbar' ? 'Bar' : id === 'stackedbar' ? 'StackingBar' : id === 'normalline' ? 'Line' : id === 'stackedline' ? 'StackingLine'
            : id === 'normalarea' ? 'Area' : id === 'rangearea' ? 'RangeArea' : 'Bar';
    };
    var getDialogTitle = function () {
        return chartType === 'Bar' ? 'Bar Chart' : chartType === 'StackingBar' ? 'Stacked Bar Chart' : chartType === 'Line' ? 'Line Chart'
            : chartType === 'StackingLine' ? 'Stacked Line Chart' : chartType === 'Area' ? 'Area Chart' : chartType === 'RangeArea' ? 'Range Area Chart' : 'Bar Chart';
    };
    var getColumnFacetDataSource = function () {
        return chartType === 'Bar' || chartType === 'StackingBar' ? ['Rectangle', 'Cylinder'] : [];
    };
    var getColumnFacetValue = function () {
        return 'Rectangle';
    };
    var getColumnWidthValue = function () {
        return 0.5;
    };
    var getBorderValue = function () {
        return { width: 1, color: '', dashArray: '' };
    };
    var getDashArrayLineValue = function () {
        return '';
    };
    var getLegendPositionDataSource = function () {
        return ['Auto', 'Top', 'Left', 'Bottom', 'Right'];
    };
    var getLegendAlignmentDataSource = function () {
        return ['Near', 'Center', 'Far'];
    };
    var getLegendLayoutDataSource = function () {
        return ['Auto', 'Horizontal', 'Vertical'];
    };
    var chartType;
    var chartInfo;
    var minMaxButton;
    var minMaxElement;
    var chart;
    var chartElement;
    var tab;
    var tabElement;
    var chartTabElement;
    var dataTabElement;
    var dataGridElement;
    var dataGrid;
    var propertiesTabElement;
    var seriesDropDownListObject;
    var seriesElement;
    var seriesColorContainer;
    var seriesColorPickerObject;
    var seriesColorElement;
    var columnFacetDropDownListObject;
    var columnFacetElement;
    var columnWidthNumericTextBoxObject;
    var columnWidthElement;
    var borderContainer;
    var borderSwitchObject;
    var borderElement;
    var borderWidthNumericTextBoxObject;
    var borderWidthElement;
    var borderColorContainer;
    var borderColorPickerObject;
    var borderColorElement;
    var borderStrokeWidthNumericTextBoxObject;
    var borderStrokeWidthElement;
    var borderStrokeGapNumericTextBoxObject;
    var borderStrokeGapElement;
    var dashArrayContainer;
    var dashArraySwitchObject;
    var dashArrayElement;
    var lineWidthNumericTextBoxObject;
    var lineWidthElement;
    var lineGapNumericTextBoxObject;
    var lineGapElement;
    var legendContainer;
    var legendSwitchObject;
    var legendElement;
    var legendPositionDropDownListObject;
    var legendPositionElement;
    var legendAlignmentDropDownListObject;
    var legendAlignmentElement;
    var legendLayoutDropDownListObject;
    var legendLayoutElement;
    var destroy = function () {
        if (minMaxButton) {
            minMaxButton.destroy();
            minMaxButton = null;
            minMaxElement.remove();
            minMaxElement = null;
        }
        if (chart) {
            chart.destroy();
            chart = null;
            chartElement.remove();
            chartElement = null;
        }
        if (dataGrid) {
            dataGrid.destroy();
            dataGrid = null;
            dataGridElement.remove();
            dataGridElement = null;
        }
        if (seriesDropDownListObject) {
            seriesDropDownListObject.destroy();
            seriesDropDownListObject = null;
            seriesElement.remove();
            seriesElement = null;
        }
        if (seriesColorPickerObject) {
            seriesColorPickerObject.destroy();
            seriesColorPickerObject = null;
            seriesColorElement.remove();
            seriesColorElement = null;
        }
        if (columnFacetDropDownListObject) {
            columnFacetDropDownListObject.destroy();
            columnFacetDropDownListObject = null;
            columnFacetElement.remove();
            columnFacetElement = null;
        }
        if (columnWidthNumericTextBoxObject) {
            columnWidthNumericTextBoxObject.destroy();
            columnWidthNumericTextBoxObject = null;
            columnWidthElement.remove();
            columnWidthElement = null;
        }
        if (borderSwitchObject) {
            borderSwitchObject.destroy();
            borderSwitchObject = null;
            borderElement.remove();
            borderElement = null;
        }
        if (borderWidthNumericTextBoxObject) {
            borderWidthNumericTextBoxObject.destroy();
            borderWidthNumericTextBoxObject = null;
            borderWidthElement.remove();
            borderWidthElement = null;
        }
        if (borderColorPickerObject) {
            borderColorPickerObject.destroy();
            borderColorPickerObject = null;
            borderColorElement.remove();
            borderColorElement = null;
        }
        if (borderStrokeWidthNumericTextBoxObject) {
            borderStrokeWidthNumericTextBoxObject.destroy();
            borderStrokeWidthNumericTextBoxObject = null;
            borderStrokeWidthElement.remove();
            borderStrokeWidthElement = null;
        }
        if (borderStrokeGapNumericTextBoxObject) {
            borderStrokeGapNumericTextBoxObject.destroy();
            borderStrokeGapNumericTextBoxObject = null;
            borderStrokeGapElement.remove();
            borderStrokeGapElement = null;
        }
        if (dashArraySwitchObject) {
            dashArraySwitchObject.destroy();
            dashArraySwitchObject = null;
            dashArrayElement.remove();
            dashArrayElement = null;
        }
        if (lineWidthNumericTextBoxObject) {
            lineWidthNumericTextBoxObject.destroy();
            lineWidthNumericTextBoxObject = null;
            lineWidthElement.remove();
            lineWidthElement = null;
        }
        if (lineGapNumericTextBoxObject) {
            lineGapNumericTextBoxObject.destroy();
            lineGapNumericTextBoxObject = null;
            lineGapElement.remove();
            lineGapElement = null;
        }
        if (legendSwitchObject) {
            legendSwitchObject.destroy();
            legendSwitchObject = null;
            legendElement.remove();
            legendElement = null;
        }
        if (legendPositionDropDownListObject) {
            legendPositionDropDownListObject.destroy();
            legendPositionDropDownListObject = null;
            legendPositionElement.remove();
            legendPositionElement = null;
        }
        if (legendAlignmentDropDownListObject) {
            legendAlignmentDropDownListObject.destroy();
            legendAlignmentDropDownListObject = null;
            legendAlignmentElement.remove();
            legendAlignmentElement = null;
        }
        if (legendLayoutDropDownListObject) {
            legendLayoutDropDownListObject.destroy();
            legendLayoutDropDownListObject = null;
            legendLayoutElement.remove();
            legendLayoutElement = null;
        }
        if (tab) {
            tab.destroy();
            tab = null;
            tabElement.remove();
            tabElement = null;
        }
    };
    var initializeChart = function (chartContainer) {
        chartElement = document.createElement('div');
        chartContainer.append(chartElement);
        chart = new ej.charts.Chart({
            width: '100%',
            height: '400px',
            title: 'Sales Data'
        });
    };
    var renderChart = function (refresh) {
        var chartXAxis;
        if (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Line'
            || chartType === 'StackingLine' || chartType === 'Area' || chartType === 'RangeArea') {
            chartXAxis = {
                minimum: year,
                maximum: year + data.length,
                interval: 5,
                title: 'Year',
            };
        }
        chart.primaryXAxis = chartXAxis;
        var chartYAxis;
        if (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Line'
            || chartType === 'StackingLine' || chartType === 'Area' || chartType === 'RangeArea') {
            chartYAxis = {
                minimum: chartType === 'Line' || chartType === 'StackingLine' || chartType === 'Area' ? 50 : 0,
                maximum: chartType === 'StackingBar' || chartType === 'StackingLine' ? 200 : 100,
                interval: chartType === 'StackingBar' || chartType === 'StackingLine' ? 20 : 10,
                title: chartType === 'StackingBar' || chartType === 'StackingLine' ? 'Profit and Quality' : 'Profit',
                labelFormat: '{value}%'
            };
        }
        chart.primaryYAxis = chartYAxis;
        var chartSeries = [];
        var firstSeries = {};
        firstSeries.dataSource = chartInfo.selectedRecords;
        firstSeries.type = chartType;
        firstSeries.name = 'Profit';
        if (chartType === 'Bar' || chartType === 'StackingBar'
            || chartType === 'Area' || chartType === 'RangeArea'
            || chartType === 'Line' || chartType === 'StackingLine') {
            firstSeries.xName = 'Year';
        }
        if (chartType === 'Bar' || chartType === 'StackingBar'
            || chartType === 'Area'
            || chartType === 'Line' || chartType === 'StackingLine') {
            firstSeries.yName = 'Profit';
        }
        if (chartType === 'Bar' || chartType === 'StackingBar') {
            firstSeries.columnFacet = getColumnFacetValue();
        }
        if (chartType === 'Bar' || chartType === 'StackingBar') {
            firstSeries.columnWidth = getColumnWidthValue();
        }
        if (chartType === 'Bar' || chartType === 'StackingBar'
            || chartType === 'Area' || chartType === 'RangeArea') {
            firstSeries.border = getBorderValue();
        }
        if (chartType === 'RangeArea') {
            firstSeries.high = 'Profit';
        }
        if (chartType === 'RangeArea') {
            firstSeries.low = 'Loss';
        }
        if (chartType === 'Line' || chartType === 'StackingLine') {
            firstSeries.dashArray = getDashArrayLineValue();
        }
        chartSeries.push(firstSeries);
        if (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine') {
            var secondSeries = {};
            secondSeries.dataSource = chartInfo.selectedRecords;
            secondSeries.type = chartType;
            secondSeries.name = 'Quality';
            if (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine') {
                secondSeries.xName = 'Year';
            }
            if (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine') {
                secondSeries.yName = 'Quality';
            }
            if (chartType === 'Bar' || chartType === 'StackingBar') {
                secondSeries.columnFacet = getColumnFacetValue();
            }
            if (chartType === 'Bar' || chartType === 'StackingBar') {
                secondSeries.columnWidth = getColumnWidthValue();
            }
            if (chartType === 'Bar' || chartType === 'StackingBar') {
                secondSeries.border = getBorderValue();
            }
            if (chartType === 'StackingLine') {
                secondSeries.dashArray = getDashArrayLineValue();
            }
            chartSeries.push(secondSeries);
        }
        chart.series = chartSeries;
        chart.legendSettings = {
            visible: true,
            position: 'Auto',
            alignment: 'Center',
            layout: 'Auto'
        };
        var dialogHeaderElement = chartInfo.targetElement.parentElement.querySelector('.e-dlg-header');
        dialogHeaderElement.innerText = getDialogTitle();
        refresh ? chart.refresh() : chart.appendTo(chartElement);
    };
    var initializeTab = function (tabContainer) {
        tabElement = document.createElement('div');
        tabContainer.append(tabElement);
        chartTabElement = document.createElement('div');
        chartTabElement.style.padding = '15px';
        propertiesTabElement = document.createElement('div');
        propertiesTabElement.style.padding = '15px';
        dataTabElement = document.createElement('div');
        dataTabElement.style.padding = '15px';
        tab = new ej.navigations.Tab({
            height: 400,
            items: [
                {
                    header: { text: 'Chart' },
                    content: chartTabElement
                },
                {
                    header: { text: 'Data' },
                    content: dataTabElement
                },
                {
                    header: { text: 'Properties' },
                    content: propertiesTabElement
                },
            ],
            selected: function (args) {
                if (args.selectedIndex === 1) {
                    dataGrid.freezeRefresh();
                }
            },
            loadOn: 'Init'
        }, tabElement);
        var tabContent = tab.element.querySelector('.e-content');
        tabContent.style.height = (chartInfo.targetElement.scrollHeight
            - tab.element.querySelector('.e-tab-header').scrollHeight - 20) + 'px';
        tabContent.style.overflow = 'auto';
    };
    var initializeChartTab = function () {
        for (var i = 0; i < chartList.length; i++) {
            var items = chartList[i].items;
            var parent_1 = document.createElement('div');
            parent_1.style.marginBottom = '15px';
            var titleElement = document.createElement('div');
            var titleText = document.createElement('span');
            titleText.textContent = chartList[i].text;
            titleElement.append(titleText);
            var chartListElement = document.createElement('div');
            chartListElement.style.display = 'flex';
            parent_1.append(titleElement);
            parent_1.append(chartListElement);
            var _loop_1 = function (j) {
                var chartData = items[j];
                var iconDiv = document.createElement("div");
                iconDiv.className = chartData.iconCss;
                iconDiv.title = chartData.text;
                iconDiv.classList.add('e-chart-list-icon');
                if (chartType === getChartSeriesType(chartData.id)) {
                    iconDiv.classList.add('e-chart-list-icon-selected');
                }
                iconDiv.addEventListener("click", function (args) {
                    chartType = getChartSeriesType(chartData.id);
                    chartTabElement.querySelector('.e-chart-list-icon-selected').classList.remove('e-chart-list-icon-selected');
                    args.target.classList.add('e-chart-list-icon-selected');
                    renderChart(true);
                    renderDataTab(true);
                    renderSeries(true);
                    renderLegend(true);
                });
                chartListElement.appendChild(iconDiv);
            };
            for (var j = 0; j < items.length; j++) {
                _loop_1(j);
            }
            chartTabElement.appendChild(parent_1);
        }
    };
    var initializeDataTab = function () {
        dataGridElement = document.createElement('div');
        dataTabElement.append(dataGridElement);
        dataGrid = new ej.grids.Grid({
            allowRowDragAndDrop: true
        });
    };
    var renderDataTab = function (refresh) {
        dataGrid.columns = [{ field: 'Series', headerTextAlign: 'Center' }];
        dataGrid.dataSource = chart.series.map(function (seriesData) { return ({ Series: seriesData.yName }); });
        dataGrid.rowDrop = function (args) {
            var newArray = chart.series.slice();
            var movedItem = newArray.splice(args.fromIndex, 1)[0];
            newArray.splice(args.dropIndex, 0, movedItem);
            chart.series = newArray;
            chart.refresh();
            renderSeries(true);
            renderLegend(true);
        };
        refresh ? dataGrid.freezeRefresh() : dataGrid.appendTo(dataGridElement);
        dataGrid.element.style.display = chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine' ? '' : 'none';
    };
    var initializePropertiesTab = function () {
        seriesElement = document.createElement('input');
        propertiesTabElement.append(seriesElement);
        seriesDropDownListObject = new ej.dropdowns.DropDownList({
            placeholder: 'Series',
            floatLabelType: 'Always',
            width: 250
        });
        seriesColorContainer = document.createElement('div');
        seriesColorContainer.style.display = 'flex';
        propertiesTabElement.append(seriesColorContainer);
        var seriesColorText = document.createElement('div');
        seriesColorText.innerText = 'Series Color';
        seriesColorContainer.append(seriesColorText);
        seriesColorElement = document.createElement('input');
        seriesColorContainer.append(seriesColorElement);
        seriesColorPickerObject = new ej.inputs.ColorPicker({});
        columnFacetElement = document.createElement('input');
        propertiesTabElement.append(columnFacetElement);
        columnFacetDropDownListObject = new ej.dropdowns.DropDownList({
            placeholder: 'Column Facet',
            floatLabelType: 'Always',
            width: 250
        });
        columnWidthElement = document.createElement('input');
        propertiesTabElement.append(columnWidthElement);
        columnWidthNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Column Width',
            floatLabelType: 'Always',
            width: 250
        });
        borderContainer = document.createElement('div');
        borderContainer.style.display = 'flex';
        propertiesTabElement.append(borderContainer);
        var borderText = document.createElement('div');
        borderText.innerText = 'Border';
        borderContainer.append(borderText);
        borderElement = document.createElement('input');
        borderContainer.append(borderElement);
        borderSwitchObject = new ej.buttons.Switch({ onLabel: 'On', offLabel: 'Off' });
        borderWidthElement = document.createElement('input');
        propertiesTabElement.append(borderWidthElement);
        borderWidthNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Border Width',
            floatLabelType: 'Always',
            width: 250
        });
        borderColorContainer = document.createElement('div');
        borderColorContainer.style.display = 'flex';
        propertiesTabElement.append(borderColorContainer);
        var borderColorText = document.createElement('div');
        borderColorText.innerText = 'Border Color';
        borderColorContainer.append(borderColorText);
        borderColorElement = document.createElement('input');
        borderColorContainer.append(borderColorElement);
        borderColorPickerObject = new ej.inputs.ColorPicker({});
        borderStrokeWidthElement = document.createElement('input');
        propertiesTabElement.append(borderStrokeWidthElement);
        borderStrokeWidthNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Border Stroke Width',
            floatLabelType: 'Always',
            width: 250
        });
        borderStrokeGapElement = document.createElement('input');
        propertiesTabElement.append(borderStrokeGapElement);
        borderStrokeGapNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Border Stroke Gap',
            floatLabelType: 'Always',
            width: 250
        });
        dashArrayContainer = document.createElement('div');
        dashArrayContainer.style.display = 'flex';
        propertiesTabElement.append(dashArrayContainer);
        var dashArrayText = document.createElement('div');
        dashArrayText.innerText = 'Dash Line';
        dashArrayContainer.append(dashArrayText);
        dashArrayElement = document.createElement('input');
        dashArrayContainer.append(dashArrayElement);
        dashArraySwitchObject = new ej.buttons.Switch({ onLabel: 'On', offLabel: 'Off' });
        lineWidthElement = document.createElement('input');
        propertiesTabElement.append(lineWidthElement);
        lineWidthNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Line Stroke Width',
            floatLabelType: 'Always',
            width: 250
        });
        lineGapElement = document.createElement('input');
        propertiesTabElement.append(lineGapElement);
        lineGapNumericTextBoxObject = new ej.inputs.NumericTextBox({
            placeholder: 'Line Stroke Gap',
            floatLabelType: 'Always',
            width: 250
        });
        legendContainer = document.createElement('div');
        legendContainer.style.display = 'flex';
        propertiesTabElement.append(legendContainer);
        var legendText = document.createElement('div');
        legendText.innerText = 'Legend';
        legendContainer.append(legendText);
        legendElement = document.createElement('input');
        legendContainer.append(legendElement);
        legendSwitchObject = new ej.buttons.Switch({ onLabel: 'On', offLabel: 'Off' });
        legendPositionElement = document.createElement('input');
        propertiesTabElement.append(legendPositionElement);
        legendPositionDropDownListObject = new ej.dropdowns.DropDownList({
            placeholder: 'Legend Position',
            floatLabelType: 'Always',
            width: 250
        });
        legendAlignmentElement = document.createElement('input');
        propertiesTabElement.append(legendAlignmentElement);
        legendAlignmentDropDownListObject = new ej.dropdowns.DropDownList({
            placeholder: 'Legend Alignment',
            floatLabelType: 'Always',
            width: 250
        });
        legendLayoutElement = document.createElement('input');
        propertiesTabElement.append(legendLayoutElement);
        legendLayoutDropDownListObject = new ej.dropdowns.DropDownList({
            placeholder: 'Legend Layout',
            floatLabelType: 'Always',
            width: 250
        });
    };
    var renderSeries = function (refresh) {
        var seriesDataSource = chart.series.map(function (series) { return series.yName; });
        seriesDropDownListObject.dataSource = seriesDataSource;
        seriesDropDownListObject.value = seriesDataSource[0];
        seriesDropDownListObject.change = function () {
            renderSeriesProperties(true);
        };
        refresh ? seriesDropDownListObject.refresh() : seriesDropDownListObject.appendTo(seriesElement);
        seriesDropDownListObject.element.parentElement.style.display = chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine' ? '' : 'none';
        seriesDropDownListObject.element.parentElement.style.marginBottom = '15px';
        renderSeriesProperties(refresh);
    };
    var renderLegend = function (refresh) {
        legendSwitchObject.change = function (args) {
            chart.legendSettings.visible = args.checked;
            chart.refresh();
            renderLegendProperties(true);
        };
        legendSwitchObject.checked = chart.legendSettings.visible;
        refresh ? legendSwitchObject.refresh() : legendSwitchObject.appendTo(legendElement);
        legendSwitchObject.element.parentElement.style.marginLeft = '10px';
        legendContainer.style.display = chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Area' || chartType === 'RangeArea' || chartType === 'Line' || chartType === 'StackingLine' ? 'flex' : 'none';
        legendSwitchObject.element.parentElement.style.marginBottom = '15px';
        renderLegendProperties(refresh);
    };
    var renderLegendProperties = function (refresh) {
        var visible = (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Area'
            || chartType === 'RangeArea' || chartType === 'Line' || chartType === 'StackingLine') && legendSwitchObject.checked;
        legendPositionDropDownListObject.dataSource = getLegendPositionDataSource();
        legendPositionDropDownListObject.value = chart.legendSettings.position;
        legendPositionDropDownListObject.change = function (args) {
            chart.legendSettings.position = args.value;
            chart.refresh();
        };
        refresh ? legendPositionDropDownListObject.refresh() : legendPositionDropDownListObject.appendTo(legendPositionElement);
        legendPositionDropDownListObject.element.parentElement.style.display = visible ? '' : 'none';
        legendPositionDropDownListObject.element.parentElement.style.marginBottom = '15px';
        legendAlignmentDropDownListObject.dataSource = getLegendAlignmentDataSource();
        legendAlignmentDropDownListObject.value = chart.legendSettings.alignment;
        legendAlignmentDropDownListObject.change = function (args) {
            chart.legendSettings.alignment = args.value;
            chart.refresh();
        };
        refresh ? legendAlignmentDropDownListObject.refresh() : legendAlignmentDropDownListObject.appendTo(legendAlignmentElement);
        legendAlignmentDropDownListObject.element.parentElement.style.display = visible ? '' : 'none';
        legendAlignmentDropDownListObject.element.parentElement.style.marginBottom = '15px';
        legendLayoutDropDownListObject.dataSource = getLegendLayoutDataSource();
        legendLayoutDropDownListObject.value = chart.legendSettings.layout;
        legendLayoutDropDownListObject.change = function (args) {
            chart.legendSettings.layout = args.value;
            chart.refresh();
        };
        refresh ? legendLayoutDropDownListObject.refresh() : legendLayoutDropDownListObject.appendTo(legendLayoutElement);
        legendLayoutDropDownListObject.element.parentElement.style.display = (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'StackingLine') && legendSwitchObject.checked ? '' : 'none';
        legendLayoutDropDownListObject.element.parentElement.style.marginBottom = '15px';
    };
    var renderSeriesProperties = function (refresh) {
        var series = chart.series[chart.series.findIndex(function (series) { return series.yName === seriesDropDownListObject.value; })];
        seriesColorPickerObject.value = series.fill;
        seriesColorPickerObject.change = function (args) {
            if (series.fill !== args.value) {
                series.fill = args.value;
                chart.refresh();
            }
        };
        refresh ? seriesColorPickerObject.refresh() : seriesColorPickerObject.appendTo(seriesColorElement);
        seriesColorContainer.style.display = chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Area' || chartType === 'RangeArea' || chartType === 'Line' || chartType === 'StackingLine' ? 'flex' : 'none';
        seriesColorPickerObject.element.parentElement.style.marginBottom = '15px';
        seriesColorPickerObject.element.parentElement.style.marginLeft = '10px';
        columnFacetDropDownListObject.dataSource = getColumnFacetDataSource();
        columnFacetDropDownListObject.value = series.columnFacet;
        columnFacetDropDownListObject.change = function (args) {
            series.columnFacet = args.value;
            chart.refresh();
        };
        refresh ? columnFacetDropDownListObject.refresh() : columnFacetDropDownListObject.appendTo(columnFacetElement);
        columnFacetDropDownListObject.element.parentElement.style.display = chartType === 'Bar' || chartType === 'StackingBar' ? '' : 'none';
        columnFacetDropDownListObject.element.parentElement.style.marginBottom = '15px';
        columnWidthNumericTextBoxObject.min = 0.2;
        columnWidthNumericTextBoxObject.max = 0.8;
        columnWidthNumericTextBoxObject.step = 0.1;
        columnWidthNumericTextBoxObject.value = series.columnWidth;
        columnWidthNumericTextBoxObject.change = function (args) {
            if (series.columnWidth !== args.value) {
                series.columnWidth = args.value;
                chart.refresh();
            }
        };
        refresh ? null : columnWidthNumericTextBoxObject.appendTo(columnWidthElement);
        columnWidthNumericTextBoxObject.element.parentElement.style.display = chartType === 'Bar' || chartType === 'StackingBar' ? '' : 'none';
        columnWidthNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
        borderSwitchObject.change = function (args) {
            series.border = args.checked ? { width: 2, color: '#404041ff', dashArray: '5,5' } : getBorderValue();
            chart.refresh();
            renderBorderProperties(true);
        };
        borderSwitchObject.checked = getBorderValue().color === series.border.color && getBorderValue().width === series.border.width
            && getBorderValue().dashArray === series.border.dashArray ? false : true;
        refresh ? borderSwitchObject.refresh() : borderSwitchObject.appendTo(borderElement);
        borderSwitchObject.element.parentElement.style.marginLeft = '10px';
        borderContainer.style.display = chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Area' || chartType === 'RangeArea' ? 'flex' : 'none';
        borderSwitchObject.element.parentElement.style.marginBottom = '15px';
        renderBorderProperties(refresh);
        dashArraySwitchObject.change = function (args) {
            series.dashArray = args.checked ? '5,5' : getDashArrayLineValue();
            chart.refresh();
            renderLineProperties(true);
        };
        dashArraySwitchObject.checked = getDashArrayLineValue() === series.dashArray ? false : true;
        refresh ? dashArraySwitchObject.refresh() : dashArraySwitchObject.appendTo(dashArrayElement);
        dashArraySwitchObject.element.parentElement.style.marginLeft = '10px';
        dashArrayContainer.style.display = chartType === 'Line' || chartType === 'StackingLine' ? 'flex' : 'none';
        dashArraySwitchObject.element.parentElement.style.marginBottom = '15px';
        renderLineProperties(refresh);
    };
    var renderLineProperties = function (refresh) {
        var series = chart.series[chart.series.findIndex(function (series) { return series.yName === seriesDropDownListObject.value; })];
        var visible = (chartType === 'Line' || chartType === 'StackingLine') && dashArraySwitchObject.checked;
        var dashArray = series.dashArray.split(',');
        lineWidthNumericTextBoxObject.min = 5;
        lineWidthNumericTextBoxObject.max = 20;
        lineWidthNumericTextBoxObject.step = 1;
        lineWidthNumericTextBoxObject.value = parseInt(dashArray[0] ? dashArray[0].trim() : '0', 10);
        lineWidthNumericTextBoxObject.change = function (args) {
            var dash = series.dashArray.split(',');
            if (visible && parseInt(dash[0].trim(), 10) !== args.value) {
                series.dashArray = args.value + ',' + lineGapNumericTextBoxObject.value;
                chart.refresh();
            }
        };
        refresh ? null : lineWidthNumericTextBoxObject.appendTo(lineWidthElement);
        lineWidthNumericTextBoxObject.element.parentElement.style.display = visible ? '' : 'none';
        lineWidthNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
        lineGapNumericTextBoxObject.min = 5;
        lineGapNumericTextBoxObject.max = 20;
        lineGapNumericTextBoxObject.step = 1;
        lineGapNumericTextBoxObject.value = parseInt(dashArray[1] ? dashArray[1].trim() : '0', 10);
        lineGapNumericTextBoxObject.change = function (args) {
            var dash = series.dashArray.split(',');
            if (visible && parseInt(dash[1].trim(), 10) !== args.value) {
                series.dashArray = lineWidthNumericTextBoxObject.value + ',' + args.value;
                chart.refresh();
            }
        };
        refresh ? null : lineGapNumericTextBoxObject.appendTo(lineGapElement);
        lineGapNumericTextBoxObject.element.parentElement.style.display = visible ? '' : 'none';
        lineGapNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
    };
    var renderBorderProperties = function (refresh) {
        var series = chart.series[chart.series.findIndex(function (series) { return series.yName === seriesDropDownListObject.value; })];
        var visible = (chartType === 'Bar' || chartType === 'StackingBar' || chartType === 'Area' || chartType === 'RangeArea') && borderSwitchObject.checked;
        borderWidthNumericTextBoxObject.min = 1;
        borderWidthNumericTextBoxObject.max = 5;
        borderWidthNumericTextBoxObject.step = 1;
        borderWidthNumericTextBoxObject.value = series.border.width;
        borderWidthNumericTextBoxObject.change = function (args) {
            if (visible && series.border.width !== args.value) {
                series.border.width = args.value;
                chart.refresh();
            }
        };
        refresh ? null : borderWidthNumericTextBoxObject.appendTo(borderWidthElement);
        borderWidthNumericTextBoxObject.element.parentElement.style.display = visible ? '' : 'none';
        borderWidthNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
        borderColorPickerObject.value = series.border.color;
        borderColorPickerObject.change = function (args) {
            if (series.border.color !== args.value) {
                series.border.color = args.value;
                chart.refresh();
            }
        };
        refresh ? borderColorPickerObject.refresh() : borderColorPickerObject.appendTo(borderColorElement);
        borderColorContainer.style.display = visible ? 'flex' : 'none';
        borderColorPickerObject.element.parentElement.style.marginBottom = '15px';
        borderColorPickerObject.element.parentElement.style.marginLeft = '10px';
        var strokeArray = series.border.dashArray.split(',');
        borderStrokeWidthNumericTextBoxObject.min = 5;
        borderStrokeWidthNumericTextBoxObject.max = 20;
        borderStrokeWidthNumericTextBoxObject.step = 1;
        borderStrokeWidthNumericTextBoxObject.value = parseInt(strokeArray[0] ? strokeArray[0].trim() : '0', 10);
        borderStrokeWidthNumericTextBoxObject.change = function (args) {
            var stroke = series.border.dashArray.split(',');
            if (visible && parseInt(stroke[0].trim(), 10) !== args.value) {
                series.border.dashArray = args.value + ',' + borderStrokeGapNumericTextBoxObject.value;
                chart.refresh();
            }
        };
        refresh ? null : borderStrokeWidthNumericTextBoxObject.appendTo(borderStrokeWidthElement);
        borderStrokeWidthNumericTextBoxObject.element.parentElement.style.display = visible ? '' : 'none';
        borderStrokeWidthNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
        borderStrokeGapNumericTextBoxObject.min = 5;
        borderStrokeGapNumericTextBoxObject.max = 20;
        borderStrokeGapNumericTextBoxObject.step = 1;
        borderStrokeGapNumericTextBoxObject.value = parseInt(strokeArray[1] ? strokeArray[1].trim() : '0', 10);
        borderStrokeGapNumericTextBoxObject.change = function (args) {
            var stroke = series.border.dashArray.split(',');
            if (visible && parseInt(stroke[1].trim(), 10) !== args.value) {
                series.border.dashArray = borderStrokeWidthNumericTextBoxObject.value + ',' + args.value;
                chart.refresh();
            }
        };
        refresh ? null : borderStrokeGapNumericTextBoxObject.appendTo(borderStrokeGapElement);
        borderStrokeGapNumericTextBoxObject.element.parentElement.style.display = visible ? '' : 'none';
        borderStrokeGapNumericTextBoxObject.element.parentElement.style.marginBottom = '15px';
    };
    var applyDialogChanges = function () {
        var dialogElement = chartInfo.targetElement.parentElement;
        var dialog = dialogElement.ej2_instances[0];
        dialogElement.style.width = '95%';
        var dialogHeaderContentElement = dialogElement.querySelector('.e-dlg-header-content');
        dialogHeaderContentElement.style.borderBottom = '1px solid gray';
        dialogHeaderContentElement.style.borderBottomLeftRadius = '0px';
        dialogHeaderContentElement.style.borderBottomRightRadius = '0px';
        minMaxElement = document.createElement('button');
        dialogHeaderContentElement.insertBefore(minMaxElement, dialogHeaderContentElement.querySelector('.e-dlg-header'));
        minMaxButton = new ej.buttons.Button({ iconCss: dialog.target === document.body ? 'e-grid-chart-dialog-min-icon' : 'e-grid-chart-dialog-max-icon', cssClass: 'e-grid-chart-dialog-min-max' }, minMaxElement);
        minMaxButton.element.addEventListener('click', function (args) {
            var target = args.target.classList.contains('e-btn') ?
                args.target.querySelector('.e-btn-icon') : args.target;
            if (target.classList.contains('e-grid-chart-dialog-min-icon')) {
                dialog.target = chartInfo.gridInstance.element;
                target.classList.remove('e-grid-chart-dialog-min-icon');
                target.classList.add('e-grid-chart-dialog-max-icon');
            }
            else {
                dialog.target = document.body;
                target.classList.remove('e-grid-chart-dialog-max-icon');
                target.classList.add('e-grid-chart-dialog-min-icon');
            }
            dialog.dataBind();
        });
    };
    var render = function () {
        applyDialogChanges();
        var customElement = document.createElement('div');
        customElement.style.display = 'flex';
        chartInfo.targetElement.append(customElement);
        var chartContainer = document.createElement('div');
        chartContainer.style.width = '70%';
        var tabContainer = document.createElement('div');
        tabContainer.style.width = '30%';
        tabContainer.style.marginLeft = '20px';
        tabContainer.style.borderLeft = '1px solid gray';
        customElement.append(chartContainer);
        customElement.append(tabContainer);
        initializeChart(chartContainer);
        renderChart();
        initializeTab(tabContainer);
        initializeChartTab();
        initializeDataTab();
        renderDataTab();
        initializePropertiesTab();
        renderSeries();
        renderLegend();
    };
    var grid = new ej.grids.Grid({
        locale: 'fr-BE',
        height: 490,
        dataSource: data,
        allowSelection: true,
        selectionSettings: { type: 'Multiple' },
        columns: [
            { type: 'checkbox', width: 50 },
            { field: 'Name', headerText: 'Product of the year', width: 150 },
            { field: 'Year', headerText: 'Year List', textAlign: 'Right', width: 100 },
            { field: 'Profit', headerText: 'Product Total Profit', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
            { field: 'Quality', headerText: 'Product Total Quality', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
            { field: 'Quantity', headerText: 'Product Total Quantity', textAlign: 'Right', width: 200 },
            { field: 'Loss', headerText: 'Product Total Loss', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
        ],
        contextMenuItems: [
            {
                text: 'Chart',
                id: 'chart',
                items: chartList,
            },
        ],
        contextMenuClick: function (args) {
            if (args.item.id === 'normalbar' || args.item.id === 'stackedbar' || args.item.id === 'normalline'
                || args.item.id === 'stackedline' || args.item.id === 'normalarea' || args.item.id === 'rangearea') {
                chartType = getChartSeriesType(args.item.id);
                var dialogArgs = { gridInstance: grid, title: 'Chart', destroy: destroy };
                grid.contextMenuModule.initDialogUI(dialogArgs).then(function (args) {
                    chartInfo = args;
                    render();
                });
            }
        }
    });
    grid.appendTo('#Grid');
</script>
</body></html>
