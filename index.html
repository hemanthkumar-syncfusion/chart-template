<!DOCTYPE html>
<html lang="en">

<head>
    <title>EJ2 Grid</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Typescript Grid Control">
    <meta name="author" content="Syncfusion">

    <script src="ej2.min.js"></script>
    <script src="https://cdn.syncfusion.com/ej2/syncfusion-helper.js"></script>

    <link href="https://cdn.syncfusion.com/ej2/29.1.39/fluent2.css" rel="stylesheet">

    <style>
        .e-grid-chart-export-icon::before {
            content: '\e72e';
        }

        .e-grid-chart-print::before {
            content: '\e75d';
        }

        .e-grid-chart-jpeg::before {
            content: '\e72e';
        }

        .e-grid-chart-png::before {
            content: '\e7ee';
        }

        .e-grid-chart-svg::before {
            content: '\e7cf';
        }

        .e-grid-chart-pdf::before {
            content: '\e700';
        }

        .e-grid-chart-xlsx::before {
            content: '\e781';
        }

        .e-grid-chart-csv::before {
            content: '\e7ba';
        }

        .e-grid-chart-icon::before {
            content: '\e826';
        }

        .e-grid-bar-chart-icon::before {
            content: '\e86c';
        }

        .e-grid-bar-icon::before {
            content: '\e86c';
        }

        .e-grid-stacking-bar-icon::before {
            content: '\e866';
        }

        .e-grid-stacking-bar-100-icon::before {
            content: '\e86d';
        }

        .e-grid-pie-icon::before {
            content: '\e869';
        }

        .e-grid-column-chart-icon::before {
            content: '\e86a';
        }

        .e-grid-column-icon::before {
            content: '\e86a';
        }

        .e-grid-stacking-column-icon::before {
            content: '\e875';
        }

        .e-grid-stacking-column-100-icon::before {
            content: '\e86f';
        }

        .e-grid-line-chart-icon::before {
            content: '\e86e';
        }

        .e-grid-line-icon::before {
            content: '\e86e';
        }

        .e-grid-stacking-line-icon::before {
            content: '\e867';
        }

        .e-grid-stacking-line-100-icon::before {
            content: '\e870';
        }

        .e-grid-area-chart-icon::before {
            content: '\e873';
        }

        .e-grid-area-icon::before {
            content: '\e873';
        }

        .e-grid-stacking-area-icon::before {
            content: '\e871';
        }

        .e-grid-stacking-area-100-icon::before {
            content: '\e86b';
        }

        .e-grid-scatter-icon::before {
            content: '\e847';
        }

        .e-grid-context-menu-dialog .e-dlg-header-content {
            padding-bottom: 14px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container {
            display: flex;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-chart-container {
            width: 510px;
            border: 1px solid #E0E0E0;
            border-top-left-radius: 4px;
            border-bottom-left-radius: 4px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-chart-container .e-grid-dialog-chart-export-container {
            padding: 6.3px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container {
            width: 268px;
            border: 1px solid #E0E0E0;
            border-top-right-radius: 4px;
            border-bottom-right-radius: 4px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab {
            display: flex;
            flex-direction: column;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-tab-header {
            border-bottom: 1px solid #E0E0E0;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-tab-header .e-grid-chart-tab-changes {
            color: #0f6cbd;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content {
            overflow-y: auto;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-dialogchart-bottom-spacer {
            margin-bottom: 17px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-dialogchart-left-spacer {
            margin-left: 12px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-dialogchart-display-flex {
            display: flex;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-dialogchart-display-flex-grow {
            flex-grow: 1;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-chart-props-header {
            font-family: 'Segoe UI';
            font-weight: 600;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0px;
            color: #242424;
            margin-bottom: 14px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-chart-props-normal-header {
            font-family: 'Segoe UI';
            font-weight: 400;
            font-size: 14px;
            line-height: 20px;
            letter-spacing: 0px;
            color: #242424;
            margin-bottom: 7px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-grid-dialog-data-tab-container {
            padding: 7px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-accordion .e-acrdn-item.e-select .e-acrdn-panel .e-acrdn-content {
            border-bottom: 1px solid #E0E0E0;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-accordion .e-acrdn-item.e-select .e-acrdn-panel .e-acrdn-content .e-grid-chart-list {
            display: flex;
            cursor: pointer;
            align-items: center;
            margin-top: 6px;
            margin-bottom: 6px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-accordion .e-acrdn-item.e-select .e-acrdn-panel .e-acrdn-content .e-grid-chart-list .e-icons {
            padding: 8px;
            border: 1px solid #D1D1D1;
            border-radius: 4px;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-accordion .e-acrdn-item.e-select .e-acrdn-panel .e-acrdn-content .e-grid-chart-list.e-grid-chart-list-selected .e-icons {
            background-color: #EBEBEB;
        }

        .e-grid-context-menu-dialog .e-grid-dialogchart-container .e-grid-dialog-tab-container .e-tab .e-content .e-accordion .e-acrdn-item.e-select .e-acrdn-panel .e-acrdn-content .e-grid-chart-list .e-grid-chart-text {
            margin-left: 8px;
        }
    </style>
</head>

<body>
    <div id="Grid"></div>
    <script>
        var data = [];
        var dataCount = 20;
        var year = new Date().getFullYear() - dataCount;
        var fruits = [
            "Apple",
            "Banana",
            "Mango",
            "Orange",
            "Pineapple",
            "Grapes",
            "Strawberry",
            "Watermelon",
            "Papaya",
            "Blueberry",
            "Kiwi",
            "Peach",
            "Pear",
            "Cherry",
            "Pomegranate",
            "Guava",
            "Lychee",
            "Plum",
            "Coconut",
            "Dragon fruit"
        ];
        var getRandomNumber = function (min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        };
        for (var i = 0; i < dataCount; i++) {
            var loss = getRandomNumber(5, 70);
            data.push({
                Name: fruits[Math.floor(Math.random() * fruits.length)],
                Year: year + i,
                Profit: 100 - loss,
                Loss: loss,
                Quality: getRandomNumber(20, 95),
                Quantity: getRandomNumber(50000, 70000)
            });
        }
        data.reverse();

        var chartElement;
        var chart;
        var accumulationChartElement;
        var accumulationChart;
        var chartVisible;
        var valueAccessor = function (field, data, column) {
            return data[field] + "%";
        };
        var grid = new ej.grids.Grid({
            height: 500,
            dataSource: data,
            allowSelection: true,
            selectionSettings: { type: 'Multiple' },
            enableChart: true, // Mandatory configuration for chart initialization
            showChartCode: false,
            chartSettings: {
                enablePanel: true, // To enable the chart settings panel (optional)
                destroy: function () { // For destroying the rendered chart component (optional)
                    if (chart) {
                        chart.destroy();
                        chart = null;
                        chartElement.remove();
                        chartElement = null;
                    }
                    if (accumulationChart) {
                        accumulationChart.destroy();
                        accumulationChart = null;
                        accumulationChartElement.remove();
                        accumulationChartElement = null;
                    }
                },
                // targetElement: document.body, // Target DOM element for appending the dialog component (optional)
                width: '825px', // Dialog component width (optional)
                height: '490px', // Dialog component height (optional)
                categoryAxis: ['Year', 'Name'], // Providing the categoryAxis options according to user input (optional)
                series: ['Profit', 'Quality'], // Providing the series options according to user input (optional)
                enableExport: true, // For enabling the chart export option (optional)
                // exportOption: [
                //     'PDF', 'Print'
                // ] // For configuring the chart export option (optional)
            }, // For configuring the chart (optional)
            contextMenuItems: [
                'PdfExport',
                'Bar', 'StackingBar', 'StackingBar100',
                'Pie',
                'Column', 'StackingColumn', 'StackingColumn100',
                'Line', 'StackingLine', 'StackingLine100',
                'Area', 'StackingArea', 'StackingArea100',
                'Scatter'
            ], // Mandatory configuration to enable chart options in the context menu or panel settings.
            columns: [
                { type: 'checkbox', width: 50 },
                { field: 'Name', headerText: 'Product of the year', width: 150 },
                { field: 'Year', headerText: 'Year List', textAlign: 'Right', width: 100 },
                { field: 'Profit', headerText: 'Product Total Profit', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
                { field: 'Quality', headerText: 'Product Total Quality', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
                { field: 'Quantity', headerText: 'Product Total Quantity', textAlign: 'Right', width: 200 },
                { field: 'Loss', headerText: 'Product Total Loss', valueAccessor: valueAccessor, textAlign: 'Right', width: 200 },
            ],
            renderChart: function (args) { // Mandatory configuration for chart rendering and exporting
                if (args.action === 'Export') {
                    var currentChart = chartVisible ? chart : accumulationChart;
                    if (args.exportOption.text === 'Print') {
                        currentChart.print();
                    }
                    else {
                        currentChart.exportModule.export(args.exportOption.text, 'Chart');
                    }
                }
                if (args.action === 'Render' || args.action === 'Update') {
                    if (args.action === 'Render') {
                        args.targetElement.style.display = 'flex';
                        args.targetElement.style.justifyContent = 'center';
                        chartElement = document.createElement('div');
                        chartElement.style.display = 'none';
                        accumulationChartElement = document.createElement('div');
                        accumulationChartElement.style.display = 'none';
                        args.targetElement.append(chartElement);
                        args.targetElement.append(accumulationChartElement);
                    }
                    if ([
                        'Bar', 'StackingBar', 'StackingBar100',
                        'Column', 'StackingColumn', 'StackingColumn100',
                        'Line', 'StackingLine', 'StackingLine100',
                        'Area', 'StackingArea', 'StackingArea100',
                        'Scatter'
                    ].indexOf(args.chartType) !== -1) {
                        chartVisible = true;
                        var chartFlag = false;
                        if (!chart) {
                            chartFlag = true;
                            chart = new ej.charts.Chart({
                                height: '290px',
                                width: '450px',
                            });
                        }
                        var chartXAxis = void 0;
                        if (args.chartSettings.categoryAxis === 'Year') {
                            chartXAxis = {
                                minimum: year,
                                maximum: year + data.length,
                                interval: 5,
                                valueType: 'Double'
                            };
                        }
                        else if (args.chartSettings.categoryAxis === 'Name') {
                            chartXAxis = {
                                interval: null,
                                minimum: null,
                                maximum: null,
                                valueType: 'Category',
                            };
                        }
                        chart.primaryXAxis = chartXAxis;
                        chart.primaryYAxis = {
                            minimum: 0,
                            maximum: 200,
                            interval: 20,
                            valueType: 'Double'
                        };
                        if (args.chartSettings.axes === 'Category Axis') {
                            chart.primaryXAxis.isInversed = args.chartSettings.axesInversed;
                            chart.primaryXAxis.title = args.chartSettings.axesTitle;
                            chart.primaryXAxis.titleStyle.fontFamily = args.chartSettings.axesTitleFont;
                            chart.primaryXAxis.titleStyle.size = args.chartSettings.axesTitleSize + 'px';
                            chart.primaryXAxis.titleStyle.color = args.chartSettings.axesTitleColor;
                            chart.primaryXAxis.labelStyle.fontFamily = args.chartSettings.axesLabelFont;
                            chart.primaryXAxis.labelStyle.size = args.chartSettings.axesLabelSize + 'px';
                            chart.primaryXAxis.labelStyle.color = args.chartSettings.axesLabelColor;
                            chart.primaryXAxis.labelRotation = args.chartSettings.axesLabelRotation;
                        }
                        else if (args.chartSettings.axes === 'Value Axis') {
                            chart.primaryYAxis.isInversed = args.chartSettings.axesInversed;
                            chart.primaryYAxis.title = args.chartSettings.axesTitle;
                            chart.primaryYAxis.titleStyle.fontFamily = args.chartSettings.axesTitleFont;
                            chart.primaryYAxis.titleStyle.size = args.chartSettings.axesTitleSize + 'px';
                            chart.primaryYAxis.titleStyle.color = args.chartSettings.axesTitleColor;
                            chart.primaryYAxis.labelStyle.fontFamily = args.chartSettings.axesLabelFont;
                            chart.primaryYAxis.labelStyle.size = args.chartSettings.axesLabelSize + 'px';
                            chart.primaryYAxis.labelStyle.color = args.chartSettings.axesLabelColor;
                            chart.primaryYAxis.labelRotation = args.chartSettings.axesLabelRotation;
                        }
                        var chartSeries = [];
                        for (var index = 0; index < args.chartSettings.series.length; index++) {
                            var tempSeries = {
                                dataSource: args.selectedRecords,
                                xName: args.chartSettings.categoryAxis,
                                yName: args.chartSettings.series[index],
                                type: args.chartType,
                                name: args.chartSettings.series[index]
                            };
                            if (args.chartSettings.stylingSeries === 'All'
                                || args.chartSettings.stylingSeries === args.chartSettings.series[index]) {
                                tempSeries.fill = args.chartSettings.seriesColor;
                                tempSeries.marker = { dataLabel: { visible: args.chartSettings.seriesDataLabel } };
                            }
                            chartSeries.push(tempSeries);
                        }
                        chart.series = chartSeries;
                        chart.tooltip = { enable: args.chartSettings.tooltip };
                        chart.margin = {
                            top: args.chartSettings.marginTop,
                            bottom: args.chartSettings.marginBottom,
                            left: args.chartSettings.marginLeft,
                            right: args.chartSettings.marginRight,
                        };
                        chart.background = args.chartSettings.background;
                        if (args.chartSettings.titleSection === 'Title') {
                            chart.title = args.chartSettings.title;
                            chart.titleStyle.fontFamily = args.chartSettings.titleFont;
                            chart.titleStyle.size = args.chartSettings.titleSize + 'px';
                            chart.titleStyle.color = args.chartSettings.titleColor;
                        }
                        else if (args.chartSettings.titleSection === 'Subtitle') {
                            chart.subTitle = args.chartSettings.title;
                            chart.subTitleStyle.fontFamily = args.chartSettings.titleFont;
                            chart.subTitleStyle.size = args.chartSettings.titleSize + 'px';
                            chart.subTitleStyle.color = args.chartSettings.titleColor;
                        }
                        chart.legendSettings = {
                            visible: args.chartSettings.legend,
                            position: args.chartSettings.legendPosition,
                            textStyle: {
                                color: args.chartSettings.legendColor,
                                size: args.chartSettings.legendSize,
                                fontFamily: args.chartSettings.legendFont
                            }
                        };
                        accumulationChartElement.style.display = 'none';
                        chartElement.style.display = '';
                        chartFlag ? chart.appendTo(chartElement) : chart.refresh();
                    }
                    if (args.chartType === 'Pie') {
                        chartVisible = false;
                        var accumulationChartFlag = false;
                        if (!accumulationChart) {
                            accumulationChartFlag = true;
                            accumulationChart = new ej.charts.AccumulationChart({
                                height: '290px',
                                width: '450px',
                            });
                        }
                        accumulationChart.series = [
                            {
                                dataSource: args.selectedRecords,
                                xName: args.chartSettings.categoryAxis,
                                yName: args.chartSettings.accumulationValueAxis,
                                type: args.chartType,
                                dataLabel: { visible: args.chartSettings.seriesDataLabel }
                            }
                        ];
                        accumulationChart.tooltip = { enable: args.chartSettings.tooltip };
                        accumulationChart.margin = {
                            top: args.chartSettings.marginTop,
                            bottom: args.chartSettings.marginBottom,
                            left: args.chartSettings.marginLeft,
                            right: args.chartSettings.marginRight,
                        };
                        accumulationChart.background = args.chartSettings.background;
                        if (args.chartSettings.titleSection === 'Title') {
                            accumulationChart.title = args.chartSettings.title;
                            accumulationChart.titleStyle.fontFamily = args.chartSettings.titleFont;
                            accumulationChart.titleStyle.size = args.chartSettings.titleSize + 'px';
                            accumulationChart.titleStyle.color = args.chartSettings.titleColor;
                        }
                        else if (args.chartSettings.titleSection === 'Subtitle') {
                            accumulationChart.subTitle = args.chartSettings.title;
                            accumulationChart.subTitleStyle.fontFamily = args.chartSettings.titleFont;
                            accumulationChart.subTitleStyle.size = args.chartSettings.titleSize + 'px';
                            accumulationChart.subTitleStyle.color = args.chartSettings.titleColor;
                        }
                        accumulationChart.legendSettings = {
                            visible: args.chartSettings.legend,
                            position: args.chartSettings.legendPosition,
                            textStyle: {
                                color: args.chartSettings.legendColor,
                                size: args.chartSettings.legendSize,
                                fontFamily: args.chartSettings.legendFont
                            }
                        };
                        chartElement.style.display = 'none';
                        accumulationChartElement.style.display = '';
                        accumulationChartFlag ? accumulationChart.appendTo(accumulationChartElement) : accumulationChart.refresh();
                    }
                }
            }
        });
        grid.appendTo('#Grid');
    </script>
</body>

</html>
